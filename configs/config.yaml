# Data Lake Configuration

# Environment
environment: development  # development, staging, production

# Storage Configuration
storage:
  minio:
    endpoint: ${MINIO_ENDPOINT:-localhost:9000}
    access_key: ${MINIO_ACCESS_KEY:-admin}
    secret_key: ${MINIO_SECRET_KEY:-minio123}
    secure: ${MINIO_SECURE:-false}
    region: us-east-1

  buckets:
    bronze: bronze
    silver: silver
    gold: gold
    warehouse: warehouse
    checkpoints: checkpoints

# Database Configuration
database:
  postgres:
    host: ${POSTGRES_HOST:-localhost}
    port: ${POSTGRES_PORT:-5432}
    database: ${POSTGRES_DB:-datalake_metadata}
    user: ${POSTGRES_USER:-postgres}
    password: ${POSTGRES_PASSWORD:-postgres123}
    pool_size: 10
    max_overflow: 20

# Kafka Configuration
kafka:
  bootstrap_servers: ${KAFKA_BOOTSTRAP_SERVERS:-localhost:9092}
  consumer_group_id: datalake-consumer
  auto_offset_reset: earliest
  enable_auto_commit: false
  max_poll_records: 500

  topics:
    events: events
    logs: logs
    metrics: metrics
    raw_data: raw-data

# Spark Configuration
spark:
  app_name: DataLake
  master: k8s://https://kubernetes.default.svc
  executor:
    instances: 10
    cores: 4
    memory: 8g
  driver:
    cores: 2
    memory: 4g
  conf:
    spark.sql.extensions: org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions
    spark.sql.catalog.iceberg: org.apache.iceberg.spark.SparkCatalog
    spark.sql.catalog.iceberg.type: hadoop
    spark.sql.catalog.iceberg.warehouse: s3a://warehouse/

# Trino Configuration
trino:
  host: ${TRINO_HOST:-localhost}
  port: ${TRINO_PORT:-8080}
  catalog: iceberg
  schema: default
  user: admin

# API Configuration
api:
  host: 0.0.0.0
  port: 8000
  workers: 4
  reload: true  # only in development
  log_level: info
  cors_origins:
    - http://localhost:3000
    - http://localhost:8000

  rate_limiting:
    enabled: true
    requests_per_minute: 1000

  cache:
    ttl: 300  # 5 minutes
    max_size: 1000

# Data Quality
data_quality:
  validation_enabled: true
  quality_threshold: 0.90  # 90% minimum

  expectations:
    - expect_column_values_to_not_be_null
    - expect_column_values_to_be_unique
    - expect_table_row_count_to_be_between

# Processing Configuration
processing:
  batch:
    enabled: true
    schedule: "0 0 * * *"  # Daily at midnight
    parallelism: 10

  streaming:
    enabled: true
    checkpoint_interval: 60  # seconds
    trigger_interval: 10  # seconds

# Data Retention
retention:
  bronze:
    days: 2555  # ~7 years
    compression: zstd

  silver:
    days: 1095  # 3 years
    compression: zstd

  gold:
    days: 365  # 1 year
    compression: zstd
    aggregates_indefinite: true

# Monitoring
monitoring:
  prometheus:
    enabled: true
    port: 9090

  grafana:
    enabled: true
    port: 3000

  logging:
    level: INFO  # DEBUG, INFO, WARN, ERROR
    format: json
    output: stdout

# Security
security:
  authentication:
    enabled: true
    method: oauth2  # oauth2, api_key, jwt

  authorization:
    rbac_enabled: true

  encryption:
    at_rest: true
    in_transit: true
    tls_version: "1.3"

# Feature Flags
features:
  multimedia_processing: true
  vector_search: true
  real_time_analytics: true
  data_catalog: true
  lineage_tracking: true
